FROM python:3.14-alpine3.21

RUN apk add --no-cache git curl ca-certificates libgcc libstdc++ ripgrep bash jq gcc musl-dev libffi-dev
RUN ln -sf /bin/bash /bin/sh

ENV USE_BUILTIN_RIPGREP=0

RUN adduser -D claude
USER claude

RUN curl -fsSL https://claude.ai/install.sh | bash

ENV PATH="/home/claude/.local/bin:$PATH"

WORKDIR /workspace

ENTRYPOINT ["sh", "-c", "ln -sf /home/claude/.claude/.claude.json /home/claude/.claude.json && exec claude --dangerously-skip-permissions \"$@\"", "--"]
